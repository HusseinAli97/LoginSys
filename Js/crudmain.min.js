//! ***********************************Enhanced Code ********************************
var pManger={productName:document.getElementById("productName"),productPrice:document.getElementById("productPrice"),productCategory:document.getElementById("productCat"),productDescription:document.getElementById("productDesc"),addBtn:document.getElementById("addBtn"),updateBtn:document.getElementById("updateBtn"),logoutBtn:document.getElementById("logOut"),localStorageName:"productStorage",emailInput:document.getElementById("Email"),searchTermValue:"",foundedItems:[],cloneFounded:[],pList:[],checkedList:[],indexing:0,
//! ***********************************functions*******************************************
invokedLocal:function(){null!==localStorage.getItem(this.localStorageName)?(this.pList=JSON.parse(localStorage.getItem(this.localStorageName)),this.showProducts(this.pList)):this.pList=[],this.showProducts(this.pList)},addProductStorage:function(t){localStorage.setItem(this.localStorageName,JSON.stringify(t))},putEmailOnNav:function(){let t=localStorage.getItem("isLoggedInEmail");this.emailInput.innerHTML=t},logOutOperation:function(){this.logoutBtn.addEventListener("click",(()=>{localStorage.removeItem("isLoggedInEmail"),this.showLoadingScreen()}))},backToLogin:function(){null===localStorage.getItem("isLoggedInEmail")&&this.showLoadingScreen()},showLoadingScreen:function(){const t=document.getElementById("loadingScreen"),e=document.querySelector(".mainSection");t.classList.replace("d-none","d-flex"),e.classList.replace("visible","invisible"),setTimeout((function(){window.location.href="../../index.html"}),3e3)},
//! ***********************************Add Products************************************************
generateUniqueId:function(){return this.pList.length>0?this.pList[this.pList.length-1].id+1:1},addProducts:function(){if(this.validation()){var t={id:this.generateUniqueId(),pName:this.productName.value,pPrice:this.productPrice.value,pCategory:this.productCategory.value,pDescription:this.productDescription.value,pLastUpdate:this.currentMoment()};this.pList.push(t),this.addProductStorage(this.pList),this.updateInputValue(),this.showProducts(this.pList),this.clearValidation(),Swal.fire({title:"Success!",text:"Product Added Successfully",icon:"success",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#9122f3",timer:1e3})}else Swal.fire({title:"Error!",text:"Please fill all the fields",icon:"warning",background:"#121013ce",color:"white",iconColor:"#cb1375",confirmButtonColor:"#6b1e7b",cancelButtonColor:"#6b1e7b",confirmButtonText:"Ok"})},
//! ***********************************Show Products*********************************************
showProducts:function(t){let e=t.length>0?t:this.pList,i="";for(let t=0;t<e.length;t++){let s=e[t].newProductName?e[t].newProductName:e[t].pName;i+=`\n                <tr>\n                    <th> <input type="checkbox" class="form-check-input non-click" id="checkBox${e[t].id}" oninput="pManger.pushCheckedProduct(${e[t].id})"> </th>\n                    <th class="text-white fw-bold" scope="row "> ${t+1}</th>\n                    <td class="text-white fw-bold">${this.getHighlightedProductName(s)}</td>\n                    <td class="text-white fw-bold">${e[t].pPrice}</td>\n                    <td class="text-white fw-bold">${e[t].pCategory}</td>\n                    <td class="text-white fw-bold">${e[t].pDescription}</td>\n                    <td class="text-white fw-bold">${e[t].pLastUpdate}</td>\n                    <td> <button class="btn btn-warning btn-sm text-uppercase fw-bold" onclick="pManger.pullUpdateValue(${e[t].id})"><i class="fa-solid fa-pen-to-square"></i></button> </td>\n                    <td>\n                        <button class="btn btn-danger btn-sm text-uppercase fw-bold" onclick="pManger.delCurrentProduct(${e[t].id})">\n                            <i class="fa-solid fa-trash-can"></i>\n                        </button>\n                    </td>\n                </tr>\n            `}document.getElementById("tbody").innerHTML=i},getHighlightedProductName:function(t){if(""!==this.searchTermValue){const e=new RegExp(this.searchTermValue,"ig");return t.replace(e,(t=>`<span class="text-danger">${t}</span>`))}return t},
//! ***********************************Add Update Inputs**********************************************
updateInputValue:function(t){this.productName.value=t?t.pName:"",this.productPrice.value=t?t.pPrice:"",this.productCategory.value=t?t.pCategory:"Select Category",this.productDescription.value=t?t.pDescription:""},
//! ***********************************Delete  Product*************************************************
dellAllProducts:function(){Swal.fire({title:"Are you sure?",text:"This action will delete all products. This cannot be undone!",icon:"warning",background:"#121013ce",color:"white",showCancelButton:!0,iconColor:"#cb1375",confirmButtonColor:"#6b1e7b",cancelButtonColor:"#6b1e7b",confirmButtonText:"Yes, save changes!",cancelButtonText:"No, cancel!"}).then((t=>{t.isConfirmed&&(this.pList.length>0?(localStorage.clear(),this.pList=[],this.showProducts(this.pList),Swal.fire({title:"Deleted!",text:"All products deleted",icon:"success",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#9122f3",timer:1500})):Swal.fire({title:"Error!",text:"There is no products to delete",icon:"warning",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#cb1375",timer:1500}))}))},delCurrentProduct:function(t){var e=this.foundedItems.length>0?this.foundedItems:this.pList,i=e.findIndex((e=>e.id===t));-1!==i?Swal.fire({title:"Are you sure?",text:"This action will delete the selected product. This cannot be undone!",icon:"warning",background:"#121013ce",color:"white",showCancelButton:!0,iconColor:"#cb1375",confirmButtonColor:"#6b1e7b",cancelButtonColor:"#6b1e7b",confirmButtonText:"Yes, save changes!",cancelButtonText:"No, cancel!"}).then((s=>{if(s.isConfirmed){e.splice(i,1)[0];var o=this.pList.findIndex((e=>e.id===t));-1!==o&&this.pList.splice(o,1),this.addProductStorage(this.pList),this.searchTermValue="",document.getElementById("search").value="",this.searchProducts(""),this.showProducts(e),Swal.fire({title:"Deleted!",text:"The selected product has been deleted.",icon:"success",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#9122f3",timer:1500})}})):Swal.fire("Product not found.","","error")},pushCheckedProduct:function(t){document.getElementById(`checkBox${t}`).checked?this.checkedList.push(this.pList.find((e=>e.id===t))):this.checkedList=this.checkedList.filter((e=>e.id!==t)),this.checkedList.length>0?document.getElementById("delSelectBtn").classList.remove("disabled"):document.getElementById("delSelectBtn").classList.add("disabled")},delSelectedProducts:function(){Swal.fire({title:"Are you sure?",text:"This action will delete selected products. This cannot be undone!",icon:"warning",background:"#121013ce",color:"white",showCancelButton:!0,iconColor:"#cb1375",confirmButtonColor:"#6b1e7b",cancelButtonColor:"#6b1e7b",confirmButtonText:"Yes, save changes!",cancelButtonText:"No, cancel!"}).then((t=>{if(t.isConfirmed){let t=this.foundedItems.length>0?[...this.foundedItems]:[...this.pList];t=t.filter((t=>!this.checkedList.includes(t))),this.foundedItems.length>0?(this.pList=t.filter((t=>!t.newProductName)),this.foundedItems=t.filter((t=>t.newProductName))):this.pList=t,this.pList.forEach((t=>delete t.newProductName)),this.searchTermValue="",document.getElementById("search").value="",this.searchProducts(""),this.addProductStorage(this.pList),this.checkedList=[],this.showProducts(t),document.getElementById("delSelectBtn").classList.add("disabled"),Swal.fire({title:"Deleted!",text:"The selected products have been deleted.",icon:"success",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#9122f3",timer:1500})}else this.checkedList=[],document.getElementById("delSelectBtn").classList.add("disabled")}))},
//! *******************************Update & Edit Product****************************
pullUpdateValue:function(t){let e=this.foundedItems.length>0?this.foundedItems:this.pList,i=e.find((e=>e.id===t));this.updateInputValue(i),this.addBtn.classList.add("d-none"),this.updateBtn.classList.replace("d-none","d-block"),this.indexing=e.indexOf(i)},pushUpdateValue:function(){this.validation()&&Swal.fire({title:"Save Changes?",text:"Are you sure you want to save the changes?",icon:"warning",background:"#121013ce",color:"white",showCancelButton:!0,iconColor:"#cb1375",confirmButtonColor:"#6b1e7b",cancelButtonColor:"#6b1e7b",confirmButtonText:"Yes, save changes!",cancelButtonText:"No, cancel!"}).then((t=>{if(t.isConfirmed){let t=this.foundedItems.length>0?this.foundedItems:this.pList;t[this.indexing].pName=this.productName.value,t[this.indexing].pPrice=this.productPrice.value,t[this.indexing].pCategory=this.productCategory.value,t[this.indexing].pDescription=this.productDescription.value,t[this.indexing].pLastUpdate=this.currentMoment(),this.showProducts(t),this.addProductStorage(this.pList),this.updateInputValue(),this.addBtn.classList.replace("d-none","d-block"),this.updateBtn.classList.replace("d-block","d-none"),this.clearValidation(),this.showProducts(this.pList),this.searchProducts(this.searchTermValue),Swal.fire({title:"Saved!",text:"The changes have been saved.",icon:"success",background:"#121013ce",color:"white",showConfirmButton:!1,iconColor:"#9122f3",timer:1500})}else this.addBtn.classList.replace("d-none","d-block"),this.updateBtn.classList.replace("d-block","d-none"),this.updateInputValue(),this.clearValidation()}))},
//! ********************************Search for Product**********************************
searchProducts:function(t){if(this.searchTermValue=t.trim(),this.foundedItems=[],""!==this.searchTermValue)for(let t=0;t<this.pList.length;t++)new RegExp(this.searchTermValue,"ig").test(this.pList[t].pName)&&this.foundedItems.push(this.pList[t]);0===this.foundedItems.length&&""!==this.searchTermValue?document.getElementById("tbody").innerHTML='<tr><td colspan="9" class="text-center text-white">No products found</td></tr>':this.showProducts(this.foundedItems.length>0?this.foundedItems:this.pList)},resetHighlight:function(){this.foundedItems=[],this.showProducts(this.pList)},
//! ***************************Validation for Product****************************
checkValidate:function(t,e){return e.test(t)},checkEmpty:function(){isNameEmpty=""==this.productName.value,isPriceEmpty=""==this.productPrice.value,isCategoryEmpty="Select Category"==this.productCategory.value,isDescriptionEmpty=""==this.productDescription.value,isNameEmpty&&this.productName.classList.remove("is-invalid"),isPriceEmpty&&this.productPrice.classList.remove("is-invalid"),isCategoryEmpty&&this.productCategory.classList.remove("is-invalid"),isDescriptionEmpty&&this.productDescription.classList.remove("is-invalid")},validation:function(){var t=this.checkValidate(this.productName.value,/^[A-Z][a-z]{2,8}([0-9]){0,2}$/g),e=this.checkValidate(this.productPrice.value,/^([1-9][0-9]{3}|10000)$/),i="Select Category"!==this.productCategory.value,s=this.checkValidate(this.productDescription.value,/^[a-z0-9]{1,250}$/gi);return this.productName.classList.toggle("is-valid",t),this.productName.classList.toggle("is-invalid",!t),this.productPrice.classList.toggle("is-valid",e),this.productPrice.classList.toggle("is-invalid",!e),this.productCategory.classList.toggle("is-valid",i),this.productCategory.classList.toggle("is-invalid",!i),this.productDescription.classList.toggle("is-valid",s),this.productDescription.classList.toggle("is-invalid",!s),this.checkEmpty(),t&&e&&i&&s},clearValidation:function(){this.productName.classList.remove("is-valid"),this.productPrice.classList.remove("is-valid"),this.productCategory.classList.remove("is-valid"),this.productDescription.classList.remove("is-valid")},
//! ***********************************Add Date Of Edit************************************************
currentMoment:()=>moment().format("ddd,DMMMM,h:mmA")};pManger.invokedLocal(),pManger.putEmailOnNav(),pManger.logOutOperation(),pManger.backToLogin();